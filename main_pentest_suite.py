import sys
import warnings

# Importar los scripts de los 3 requerimientos
# Asegúrate de que los nombres de los archivos coincidan con estos
try:
    from recon_scanner import main as recon_main
    from service_enumerator import main as enum_main
    from web_vuln_scanner import main as vuln_main
except ImportError as e:
    print(f"Error al importar un módulo. Asegúrate de que los archivos .py están en la misma carpeta. Detalles: {e}")
    sys.exit(1)

def run_all_scans():
    """
    Función principal que orquesta la ejecución de los 3 scripts.
    """
    # Suprimir las advertencias de urllib3 (LibreSSL) si aparecen
    warnings.filterwarnings("ignore", category=UserWarning, module='urllib3')
    
    print("=====================================================")
    print("=== Suite de Hacking Ético Automatizada v1.0      ===")
    print("=====================================================")
    print("\n[+] Iniciando el flujo de un test de penetración...")
    
    # --- 1. Requerimiento 1: Reconocimiento ---
    print("\n-----------------------------------------------------")
    print("--- FASE 1: RECONOCIMIENTO DE SUPERFICIE DE ATAQUE  ---")
    print("-----------------------------------------------------\n")
    try:
        recon_main()
    except Exception as e:
        print(f"\n[!] Error en la fase de Reconocimiento: {e}")
        print("[!] Saliendo de la suite...")
        return
        
    # --- 2. Requerimiento 2: Enumeración de Servicios ---
    print("\n-----------------------------------------------------")
    print("--- FASE 2: ENUMERACIÓN DE SERVICIOS                ---")
    print("-----------------------------------------------------\n")
    try:
        enum_main()
    except Exception as e:
        print(f"\n[!] Error en la fase de Enumeración: {e}")
        print("[!] Saliendo de la suite...")
        return
        
    # --- 3. Requerimiento 3: Explotación de Vulnerabilidades Web ---
    print("\n-----------------------------------------------------")
    print("--- FASE 3: EXPLOTACIÓN DE VULNERABILIDADES WEB     ---")
    print("-----------------------------------------------------\n")
    try:
        vuln_main()
    except Exception as e:
        print(f"\n[!] Error en la fase de Explotación: {e}")
        print("[!] Saliendo de la suite...")
        return

    print("\n=====================================================")
    print("=== Suite de Hacking Ético finalizada             ===")
    print("=====================================================")

if __name__ == "__main__":
    run_all_scans()